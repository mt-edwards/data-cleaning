---
title: "Data Cleaning"
author: "Matthew Edwards"
date: "14/09/2021"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(reticulate)
```

## Introduction

**Clean data** are data that can be used for exploratory data analysis (EDA). **Data cleaning** is the process of transforming raw data into clean data. The process of data cleaning involves five steps:

1. Columns names
2. Missing values
3. Column types
4. Dedupliction
5. Quality checking

## Raw Data

```{python}
import pandas as pd
data = pd.read_csv("data.csv")
data
```

## Column Names

```{python}
names = {
  'A': 'gender',
  'B': 'dob',
  'C': 'score',
  'D': 'grade',
}
data.rename(mapper=names, axis=1, inplace=True)
data.columns
```

## Missing Values

```{python}
import numpy as np
missing = {
  'na': np.nan,
  -1: np.nan,
}
data.replace(missing, inplace=True)
data.info()
```

## Columns Types

```{python}
from pandas.api.types import CategoricalDtype
gender_cat = CategoricalDtype(categories=["male", "female"], ordered=False)
grade_cat = CategoricalDtype(categories=["A", "B", "C", "D"], ordered=True)
types = {
  'gender': gender_cat,
  'dob': 'datetime64',
  'score': 'float64',
  'grade': grade_cat,
}
data = data.astype(types)
data.dtypes
```

## Deduplication

```{python echo=TRUE}
data.drop_duplicates(inplace=True)
data
```

## Quality Check

```{python}
def check(row):
  A_check = row['grade'] == "A" and 90 < row['score'] <= 100 
  B_check = row['grade'] == "B" and 80 < row['score'] <= 90
  C_check = row['grade'] == "C" and 70 < row['score'] <= 80
  D_check = row['grade'] == "D" and  0 < row['score'] <= 70
  return A_check or B_check or C_check or D_check or np.isnan(row['score'])
  

any(data.apply(check, axis=1))
```
